"use strict";var c=(e=>(e.optimize_article="optimize_article",e.extract_content="extract_content",e))(c||{}),o=(e=>(e.tab_listener="tab_listener",e))(o||{}),r=(e=>(e.tab_changed="tab_changed",e))(r||{});function u(){chrome.contextMenus.create({id:"optimize-article",title:"Optimize Content",contexts:["page"]}),chrome.sidePanel.setPanelBehavior({openPanelOnActionClick:!0}).catch(e=>console.error(e))}async function m(){if("ai"in self)try{const e=await self.ai.languageModel.capabilities(),{available:t}=e;if(t==="readily"){u();return}}catch{}}function h(){chrome.contextMenus.removeAll(m)}chrome.runtime.onInstalled.addListener(h);function f(e,t){t&&t.id&&e.menuItemId==="optimize-article"&&(chrome.scripting.insertCSS({target:{tabId:t.id},files:["static/animations.css"]}),chrome.tabs.sendMessage(t.id,{action:c.optimize_article}))}chrome.contextMenus.onClicked.addListener(f);const i=new Set;async function b(e){const t=await chrome.tabs.get(e.tabId);if(!t||!t.url)return;let n=t.url;const a=new URL(n);a.hash="",n=a.href;function s(l){const d={action:r.tab_changed,payload:{url:n}};l.postMessage(d)}i.forEach(s)}function _(e){function t(){i.delete(e)}i.add(e),e.onDisconnect.addListener(t)}function g(e){e.name===o.tab_listener&&_(e)}chrome.tabs.onActivated.addListener(b);chrome.runtime.onConnect.addListener(g);
